<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GenSoftworks — Gebäude 12</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { background: #1a1a2e; overflow: hidden; font-family: monospace; color: #ccc; }
      #wrapper { display: flex; width: 100vw; height: 100vh; }
      #left { flex: 1; display: flex; flex-direction: column; min-width: 0; }
      #game-container { flex: 1; min-height: 0; position: relative; }
      #zone-overlay {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none; overflow: hidden; z-index: 10;
      }
      .zone-label {
        position: absolute; font-family: monospace; font-size: 10px;
        color: rgba(255,255,255,0.65); text-align: center; white-space: pre-line;
        text-shadow: 0 0 3px rgba(0,0,0,0.7);
        transform: translate(-50%, -50%);
      }
      #title-bar { text-align: center; padding: 6px 0; color: #556; font-size: 13px; letter-spacing: 2px; }

      /* --- Sidebar --- */
      #sidebar {
        width: 340px; min-width: 260px; background: #111122; border-left: 2px solid #333355;
        display: flex; flex-direction: column; padding: 12px; overflow-y: auto; overflow-x: hidden;
      }
      #sidebar .controls { display: flex; gap: 4px; margin-bottom: 10px; align-items: center; flex-wrap: nowrap; }
      #sidebar .nav-btn {
        background: #1a1a2e; color: #88aacc; border: 1px solid #333355;
        padding: 4px 8px; font-family: monospace; font-size: 14px; border-radius: 3px;
        cursor: pointer; line-height: 1; flex-shrink: 0;
      }
      #sidebar .nav-btn:hover { border-color: #556699; color: #aac8e8; }
      #sidebar .nav-btn:disabled { opacity: 0.3; cursor: default; }
      #sidebar .nav-group { display: flex; gap: 3px; align-items: center; flex-shrink: 0; }
      #sim-select { flex: 0 1 auto; width: 100%; margin-bottom: 2px; }
      #sidebar select {
        flex: 1 1 0; min-width: 0; background: #1a1a2e; color: #ccc; border: 1px solid #333355;
        padding: 4px 6px; font-family: monospace; font-size: 12px; border-radius: 3px;
        cursor: pointer;
      }
      #day-select { flex: 0 1 auto; width: 70px; }
      #sidebar select:hover { border-color: #556699; }
      #sidebar .divider { height: 1px; background: #333355; margin: 8px 0; }

      /* Scene header */
      .scene-header { display: flex; align-items: center; gap: 6px; margin-bottom: 4px; flex-wrap: wrap; }
      .badge {
        display: inline-block; padding: 2px 6px; border-radius: 3px;
        font-size: 10px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px;
        color: #fff; background: #334; flex-shrink: 0;
      }
      .badge.MEETING, .badge.BRIEF_REACTION { background: #2a4a6a; }
      .badge.ARRIVAL { background: #2a5a3a; }
      .badge.ENCOUNTER { background: #5a4a2a; }
      .badge.WORK, .badge.WORK_REFLECTION { background: #4a2a5a; }
      .badge.REFLECTION { background: #3a3a5a; }
      .scene-time { font-size: 11px; color: #88aacc; }
      .scene-location { font-size: 11px; color: #889; margin-bottom: 3px; }
      .scene-participants { font-size: 11px; color: #aaa; margin-bottom: 6px; line-height: 1.4; }
      .scene-participants span { color: #aac8e8; }

      /* Summary */
      .scene-summary {
        font-size: 11px; color: #bbb; line-height: 1.5; word-wrap: break-word;
        overflow-wrap: break-word;
      }

      /* Key moment */
      .key-moment {
        font-size: 10px; color: #c8a86e; font-style: italic;
        margin-top: 6px; padding: 5px 7px; background: #1a1a2e; border-radius: 3px;
        border-left: 2px solid #c8a86e; word-wrap: break-word;
      }

      /* Day summary bubble */
      .day-summary {
        margin-bottom: 10px; padding: 8px 10px; background: #151528;
        border: 1px solid #2a2a4a; border-radius: 5px;
      }
      .day-summary-header {
        display: flex; align-items: center; gap: 6px;
        font-size: 10px; color: #88aacc; text-transform: uppercase; letter-spacing: 1px;
        cursor: pointer; user-select: none;
      }
      .day-summary-header:hover { color: #aac8e8; }
      .day-summary-header .arrow {
        font-size: 8px; transition: transform 0.15s; display: inline-block;
      }
      .day-summary-header .arrow.open { transform: rotate(90deg); }
      .day-summary-body { display: none; margin-top: 6px; }
      .day-summary-body.open { display: block; }
      .day-summary-icon {
        font-size: 13px; line-height: 1; flex-shrink: 0;
      }
      .day-summary-title {
        font-size: 12px; color: #dde; font-weight: bold; margin-bottom: 5px;
      }
      .day-summary-phase {
        display: inline-block; font-size: 9px; color: #88aacc; background: #1a2a3a;
        padding: 1px 5px; border-radius: 2px; margin-bottom: 5px;
      }
      .day-summary-text {
        font-size: 11px; color: #bbb; line-height: 1.5; word-wrap: break-word;
        overflow-wrap: break-word;
      }
      .day-summary-decisions {
        margin-top: 6px; padding: 5px 7px; background: #1a1a2e; border-radius: 3px;
        border-left: 2px solid #88aacc;
      }
      .day-summary-decisions-label {
        font-size: 9px; color: #556; text-transform: uppercase; letter-spacing: 0.5px;
        margin-bottom: 3px;
      }
      .day-summary-decision {
        font-size: 10px; color: #aac8e8; padding: 1px 0; line-height: 1.4;
      }
      .day-summary-decision::before { content: '— '; color: #556; }
      .day-summary-moments {
        margin-top: 6px;
      }
      .day-summary-moment {
        font-size: 10px; color: #c8a86e; font-style: italic; padding: 2px 0;
        line-height: 1.3;
      }
      .day-summary-moment::before { content: '★ '; font-style: normal; }

      /* Artifacts */
      .artifacts-title {
        font-size: 10px; color: #556; text-transform: uppercase; letter-spacing: 1px;
        margin-top: 8px; margin-bottom: 4px;
      }
      .artifact-item {
        display: flex; align-items: center; gap: 4px;
        font-size: 10px; color: #889; padding: 2px 0;
      }
      .artifact-icon { color: #556; font-size: 9px; flex-shrink: 0; }
      .artifact-name {
        color: #7a9ab8; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
      }

      /* Artifact notes — expandable blocks with white background */
      .artifact-note { margin-bottom: 4px; }
      .artifact-note-toggle {
        background: #e8e4dc; border: 1px solid #d0c8b8; color: #444;
        font-family: monospace; font-size: 10px; padding: 4px 8px;
        border-radius: 3px; cursor: pointer; width: 100%; text-align: left;
        display: flex; align-items: center; gap: 5px;
      }
      .artifact-note-toggle:hover { border-color: #aaa; color: #222; }
      .artifact-note-toggle .arrow { font-size: 8px; transition: transform 0.15s; display: inline-block; }
      .artifact-note-toggle .arrow.open { transform: rotate(90deg); }
      .artifact-note-body {
        display: none; max-height: 400px; overflow-y: auto;
        font-size: 11px; color: #333; line-height: 1.6;
        padding: 10px 12px; background: #f5f0e8; border: 1px solid #d8d0c0;
        border-top: none; border-radius: 0 0 3px 3px;
        word-wrap: break-word; overflow-wrap: break-word;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      }
      .artifact-note-body.open { display: block; }
      .artifact-note-body h1 { font-size: 14px; font-weight: 600; color: #1a1a1a; margin: 12px 0 6px; border-bottom: 1px solid #d8d0c0; padding-bottom: 4px; }
      .artifact-note-body h2 { font-size: 13px; font-weight: 600; color: #2a4a6a; margin: 10px 0 5px; }
      .artifact-note-body h3 { font-size: 12px; font-weight: 600; color: #4a6a8a; margin: 8px 0 4px; }
      .artifact-note-body p { margin-bottom: 8px; }
      .artifact-note-body ul, .artifact-note-body ol { margin: 4px 0 8px 18px; padding: 0; }
      .artifact-note-body li { margin-bottom: 3px; }
      .artifact-note-body strong { color: #1a1a1a; font-weight: 600; }
      .artifact-note-body em { color: #555; }
      .artifact-note-body hr { border: none; border-top: 1px solid #d8d0c0; margin: 10px 0; }
      .artifact-note-body blockquote {
        border-left: 3px solid #c8c0b0; padding: 4px 10px; margin: 6px 0;
        color: #555; background: #ede8e0; border-radius: 2px;
      }

      /* Artifact image thumbnails */
      .artifact-thumbs {
        display: flex; flex-wrap: wrap; gap: 6px; margin: 6px 0;
      }
      .artifact-thumb {
        width: 72px; cursor: pointer; border-radius: 3px;
        overflow: hidden; border: 1px solid #333355;
        transition: border-color 0.15s, transform 0.15s;
      }
      .artifact-thumb:hover { border-color: #665; transform: translateY(-1px); }
      .artifact-thumb img {
        width: 100%; aspect-ratio: 1; object-fit: cover; display: block;
        background: #161210;
      }
      .artifact-thumb-label {
        display: block; padding: 2px 3px; font-family: monospace;
        font-size: 8px; color: #887; white-space: nowrap;
        overflow: hidden; text-overflow: ellipsis; background: #0d0d1a;
      }

      /* Agent details list */
      .agent-card { margin-bottom: 8px; padding-bottom: 6px; border-bottom: 1px solid #1a1a2e; }
      .agent-card-header { display: flex; align-items: baseline; gap: 5px; margin-bottom: 2px; flex-wrap: wrap; }
      .agent-name { font-size: 11px; font-weight: bold; color: #dde; }
      .agent-role { font-size: 10px; color: #667; }
      .mood-row { display: flex; gap: 4px; align-items: center; font-size: 11px; margin-bottom: 3px; flex-wrap: wrap; }
      .mood-label { color: #556; }
      .mood-value { color: #aac8e8; }
      .mood-arrow { color: #556; }
      .agent-reaction {
        font-size: 11px; color: #bbb; line-height: 1.4; margin-top: 4px;
        padding: 4px 6px; background: #1a1a2e; border-radius: 3px;
        word-wrap: break-word; overflow-wrap: break-word;
      }
      .agent-influences { font-size: 10px; color: #889; margin-top: 4px; word-wrap: break-word; }
      .agent-influences span { color: #7a9ab8; }

      /* Memories list */
      .memories-title { font-size: 10px; color: #556; text-transform: uppercase; letter-spacing: 1px; margin-top: 6px; margin-bottom: 3px; }
      .memory-item {
        font-size: 10px; color: #999; padding: 3px 0; border-bottom: 1px solid #222233;
        line-height: 1.3; word-wrap: break-word; overflow-wrap: break-word;
      }
      .memory-item .mem-type { color: #667; font-size: 9px; text-transform: uppercase; margin-right: 3px; }
      .memory-item .mem-importance { color: #c8a86e; font-size: 9px; float: right; }

      .agent-card.dimmed { opacity: 0.4; }

      /* v2: Dialogue lines */
      .dialogue-section { margin-top: 4px; }
      .dialogue-line {
        font-size: 10px; color: #aac8e8; font-style: italic;
        padding: 2px 0 2px 8px; border-left: 2px solid #334466;
        margin-bottom: 2px; word-wrap: break-word; overflow-wrap: break-word;
      }

      /* v2: Thoughts */
      .agent-thought {
        font-size: 10px; color: #b8a8c8; font-style: italic;
        padding: 3px 6px; margin-top: 3px; background: #1a1a2e; border-radius: 3px;
        border-left: 2px solid #4a3a5a; word-wrap: break-word; overflow-wrap: break-word;
      }

      /* v2: Feedback */
      .agent-feedback {
        font-size: 10px; padding: 3px 6px; margin-top: 3px; border-radius: 3px;
        word-wrap: break-word; overflow-wrap: break-word;
      }
      .agent-feedback.given { color: #8ab; background: #1a2030; border-left: 2px solid #3a5a6a; }
      .agent-feedback.received { color: #ab8; background: #201a1a; border-left: 2px solid #5a4a3a; }

      /* Trace blocks */
      .trace-block { margin-top: 6px; border-top: 1px solid #1a1a2e; padding-top: 4px; }
      .trace-block-label {
        font-size: 9px; color: #556; text-transform: uppercase; letter-spacing: 0.5px;
        margin-bottom: 3px;
      }
      .trace-toggle {
        background: #1a1a2e; border: 1px solid #333355; color: #7a8a9a;
        font-family: monospace; font-size: 10px; padding: 3px 8px;
        border-radius: 3px; cursor: pointer; width: 100%; text-align: left;
        margin-bottom: 2px; display: flex; align-items: center; gap: 5px;
      }
      .trace-toggle:hover { border-color: #556699; color: #aac8e8; }
      .trace-toggle .arrow { font-size: 8px; transition: transform 0.15s; display: inline-block; }
      .trace-toggle .arrow.open { transform: rotate(90deg); }
      .trace-body {
        display: none; max-height: 300px; overflow-y: auto;
        font-size: 10px; color: #bbb; line-height: 1.5;
        padding: 6px 8px; background: #0d0d1a; border-radius: 3px;
        margin-bottom: 3px; word-wrap: break-word; overflow-wrap: break-word;
      }
      .trace-body.open { display: block; }
      .trace-body .loading { color: #556; font-style: italic; }

      /* Transcript list (chronological) */
      .transcript-entry { margin-bottom: 2px; }
      .transcript-agent { font-size: 10px; color: #aac8e8; font-weight: bold; margin-left: 2px; }
      .transcript-turn { font-size: 9px; color: #c8a86e; margin-left: 4px; }
      .transcript-role { font-size: 9px; color: #556; margin-left: 6px; }

      /* GM transcript block — visually separated */
      .transcript-gm {
        margin-bottom: 8px; padding-bottom: 8px;
        border-bottom: 1px solid #333355;
      }
      .gm-toggle { color: #c8a86e !important; }

      /* Agent hover tooltip */
      #agent-tooltip {
        position: absolute; pointer-events: none; z-index: 100;
        background: rgba(17,17,34,0.92); border: 1px solid #334466;
        border-radius: 4px; padding: 5px 9px; font-family: monospace;
        opacity: 0; transition: opacity 0.15s;
      }
      #agent-tooltip.visible { opacity: 1; }
      #agent-tooltip .tt-name { font-size: 11px; font-weight: bold; color: #dde; display: flex; align-items: center; gap: 5px; }
      #agent-tooltip .tt-gender { font-size: 12px; opacity: 0.7; }
      #agent-tooltip .tt-flag { font-size: 11px; }
      #agent-tooltip .tt-role { font-size: 10px; color: #88aacc; }

      /* Agent profile modal */
      #agent-profile-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.6);
        z-index: 200; display: none; align-items: center; justify-content: center;
      }
      #agent-profile-overlay.open { display: flex; }
      #agent-profile {
        background: #111122; border: 2px solid #333355; border-radius: 6px;
        width: 480px; max-width: 90vw; max-height: 80vh; overflow-y: auto;
        padding: 16px; font-family: monospace; color: #ccc; position: relative;
      }
      #agent-profile .profile-close {
        position: absolute; top: 8px; right: 12px;
        background: none; border: none; color: #667; font-size: 18px;
        cursor: pointer; font-family: monospace;
      }
      #agent-profile .profile-close:hover { color: #aac8e8; }
      #agent-profile .profile-header { margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
      #agent-profile .profile-icons { font-size: 16px; line-height: 1; }
      #agent-profile .profile-name { font-size: 16px; font-weight: bold; color: #dde; }
      #agent-profile .profile-role { font-size: 12px; color: #88aacc; margin-top: 2px; }
      #agent-profile .profile-room { font-size: 11px; color: #556; margin-top: 2px; }
      #agent-profile .section-toggle {
        background: #1a1a2e; border: 1px solid #333355; color: #88aacc;
        font-family: monospace; font-size: 11px; padding: 5px 10px;
        border-radius: 3px; cursor: pointer; width: 100%; text-align: left;
        margin-bottom: 4px; display: flex; align-items: center; gap: 6px;
      }
      #agent-profile .section-toggle:hover { border-color: #556699; color: #aac8e8; }
      #agent-profile .section-toggle .arrow { font-size: 9px; transition: transform 0.15s; display: inline-block; }
      #agent-profile .section-toggle .arrow.open { transform: rotate(90deg); }
      #agent-profile .section-body { margin-bottom: 8px; }
      #agent-profile .memory-entry {
        font-size: 11px; color: #bbb; line-height: 1.5; padding: 8px 0;
        border-bottom: 1px solid #222233; word-wrap: break-word;
      }
      #agent-profile .memory-entry-header {
        font-size: 10px; color: #c8a86e; font-weight: bold; margin-bottom: 3px;
      }
      #agent-profile .memory-empty { font-size: 11px; color: #556; font-style: italic; }
      #agent-profile .bio-row { font-size: 11px; color: #bbb; padding: 4px 0; border-bottom: 1px solid #222233; }
      #agent-profile .bio-label { color: #556; margin-right: 6px; }
      #agent-profile .bio-value { color: #aac8e8; }
      #agent-profile .profile-section-content {
        font-size: 11px; color: #bbb; line-height: 1.6; padding: 6px 0;
        word-wrap: break-word; overflow-wrap: break-word;
      }
      #agent-profile .profile-section-content p { margin-bottom: 6px; }
      #agent-profile .profile-section-content strong { color: #dde; }
      #agent-profile .profile-section-content em { color: #b8a8c8; }
      #agent-profile .profile-color-dot {
        display: inline-block; width: 10px; height: 10px; border-radius: 50%;
        margin-right: 6px; vertical-align: middle;
      }

      /* Audio bar */
      #audio-bar {
        display: flex; align-items: center; gap: 8px;
        padding: 4px 10px; background: #0d0d1a; border-top: 1px solid #222233;
        font-size: 10px; color: #445; min-height: 24px;
      }
      #audio-bar .audio-controls { display: flex; align-items: center; gap: 4px; flex-shrink: 0; }
      #audio-bar .audio-btn {
        background: none; border: none; color: #556; font-size: 13px;
        cursor: pointer; font-family: monospace; padding: 0 3px;
      }
      #audio-bar .audio-btn:hover { color: #88aacc; }
      #audio-bar .audio-btn.active { color: #aac8e8; }
      #audio-bar input[type="range"] {
        width: 60px; height: 3px; -webkit-appearance: none; appearance: none;
        background: #333355; border-radius: 2px; outline: none; cursor: pointer;
      }
      #audio-bar input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none; width: 10px; height: 10px;
        background: #88aacc; border-radius: 50%; cursor: pointer;
      }
      #audio-bar .audio-credit { flex: 1; text-align: right; color: #334; font-size: 9px; }
      #audio-bar .audio-credit a { color: #445; text-decoration: none; }
      #audio-bar .audio-credit a:hover { color: #667; }

      /* --- Document Bar --- */
      #document-bar {
        display: flex; align-items: center; gap: 0;
        padding: 4px 10px; background: #0d0d1a; border-top: 1px solid #222233;
        overflow-x: auto; min-height: 32px;
      }
      .doc-group {
        display: flex; align-items: center; gap: 6px; padding: 0 10px;
      }
      .doc-group + .doc-group { border-left: 1px solid #222233; }
      .doc-group-label {
        font-size: 9px; color: #556; text-transform: uppercase; letter-spacing: 1px;
        writing-mode: horizontal-tb; flex-shrink: 0;
      }
      .doc-stack {
        display: flex; flex-direction: column; align-items: center; gap: 1px;
        cursor: pointer; flex-shrink: 0;
      }
      .doc-stack:hover .doc-page:last-child { background: #48442e; border-color: #5a5438; }
      .doc-pages {
        position: relative; width: 18px; height: 22px;
      }
      .doc-page {
        position: absolute; width: 14px; height: 18px;
        background: #2a2820; border: 1px solid #3d3828; border-radius: 1px;
      }
      .doc-page:last-child {
        background: #38352a; z-index: 2;
      }
      .doc-page:last-child::after {
        content: ''; position: absolute; top: 0; right: 0;
        width: 4px; height: 4px;
        background: linear-gradient(225deg, #0d0d1a 50%, #48442e 50%);
      }
      .doc-label {
        font-size: 8px; color: #556; text-align: center; line-height: 1;
        margin-top: 1px;
      }

      /* --- Document Modal --- */
      #document-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.6);
        z-index: 200; display: none; align-items: center; justify-content: center;
      }
      #document-overlay.open { display: flex; }
      #document-modal {
        background: #f5f0e8; border: 1px solid #d8d0c0; border-radius: 6px;
        width: 680px; max-width: 90vw; max-height: 85vh; overflow-y: auto;
        padding: 28px 36px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        color: #2a2a2a; position: relative;
        box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      }
      .doc-modal-close {
        position: absolute; top: 10px; right: 14px;
        background: none; border: none; color: #999; font-size: 20px;
        cursor: pointer; font-family: sans-serif; line-height: 1;
      }
      .doc-modal-close:hover { color: #555; }
      .doc-modal-header { display: flex; align-items: center; gap: 8px; margin-bottom: 14px; }
      .doc-modal-badge { font-size: 10px; }
      .doc-modal-badge.gdd { background: #2a4a6a; }
      .doc-modal-badge.wbb { background: #4a2a5a; }
      .doc-modal-title { font-size: 15px; font-weight: 600; color: #1a1a1a; }
      .doc-modal-version { font-size: 11px; color: #888; margin-left: auto; flex-shrink: 0; }
      .doc-modal-nav { display: flex; align-items: center; gap: 6px; margin-bottom: 14px; }
      .doc-modal-nav-btn {
        background: #ebe6dc; border: 1px solid #d0c8b8; color: #666;
        font-family: monospace; font-size: 13px; padding: 2px 8px;
        border-radius: 3px; cursor: pointer; line-height: 1;
      }
      .doc-modal-nav-btn:hover { border-color: #aaa; color: #333; }
      .doc-modal-nav-btn:disabled { opacity: 0.25; cursor: default; }
      .doc-modal-nav-label { font-size: 12px; color: #777; }
      .doc-modal-content {
        font-size: 13px; color: #333; line-height: 1.8; word-wrap: break-word;
        overflow-wrap: break-word; max-width: 60ch; margin: 0 auto;
      }
      .doc-modal-content h1 { font-size: 18px; font-weight: 600; color: #1a1a1a; margin: 24px 0 12px; border-bottom: 1px solid #d8d0c0; padding-bottom: 6px; }
      .doc-modal-content h2 { font-size: 15px; font-weight: 600; color: #2a4a6a; margin: 20px 0 10px; }
      .doc-modal-content h3 { font-size: 13px; font-weight: 600; color: #4a6a8a; margin: 16px 0 8px; }
      .doc-modal-content p { margin-bottom: 12px; }
      .doc-modal-content ul, .doc-modal-content ol { margin: 8px 0 14px 22px; padding: 0; }
      .doc-modal-content li { margin-bottom: 5px; }
      .doc-modal-content blockquote {
        border-left: 3px solid #c8c0b0; padding: 8px 16px; margin: 12px 0;
        color: #555; background: #ede8e0; border-radius: 2px;
      }
      .doc-modal-content hr { border: none; border-top: 1px solid #d8d0c0; margin: 20px 0; }
      .doc-modal-content strong { color: #1a1a1a; font-weight: 600; }
      .doc-modal-content em { color: #555; }
      .doc-modal-content code { background: #ede8e0; padding: 2px 5px; border-radius: 3px; font-size: 12px; font-family: monospace; color: #6a4a2a; }

      /* --- Gallery icon in document bar --- */
      #document-bar-content { display: flex; align-items: center; gap: 0; flex: 1; min-width: 0; overflow-x: auto; }
      .gallery-icon-btn {
        margin-left: auto; flex-shrink: 0;
        background: none; border: 1px solid #333355; border-radius: 3px;
        color: #556; font-size: 12px; cursor: pointer; padding: 2px 6px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        line-height: 1; display: flex; align-items: center; gap: 4px;
      }
      .gallery-icon-btn:hover { color: #88aacc; border-color: #556699; }
      .gallery-icon-btn.has-art { color: #c8a86e; border-color: #5a4a2a; }
      .gallery-count {
        font-size: 9px; font-family: monospace; background: #333355; color: #aac8e8;
        padding: 0 4px; border-radius: 7px; min-width: 14px; text-align: center;
        line-height: 14px; display: none;
      }
      .gallery-icon-btn.has-art .gallery-count { display: inline-block; background: #5a4a2a; color: #e8d0a0; }

      /* --- Gallery Board --- */
      #gallery-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.65);
        z-index: 200; display: none; align-items: center; justify-content: center;
      }
      #gallery-overlay.open { display: flex; }
      #gallery-board {
        background: #2a2218; border: 2px solid #44382a;
        border-radius: 6px; width: 900px; max-width: 94vw; max-height: 88vh;
        overflow-y: auto; padding: 20px; position: relative;
        box-shadow: 0 8px 32px rgba(0,0,0,0.5);
      }
      .gallery-close {
        position: absolute; top: 8px; right: 12px;
        background: none; border: none; color: #776; font-size: 20px;
        cursor: pointer; font-family: sans-serif; line-height: 1;
      }
      .gallery-close:hover { color: #c8c0a0; }
      .gallery-header {
        font-family: monospace; font-size: 11px; color: #665;
        text-transform: uppercase; letter-spacing: 2px; margin-bottom: 14px;
        border-bottom: 1px solid #3a3020; padding-bottom: 8px;
      }
      .gallery-empty {
        font-family: monospace; font-size: 11px; color: #554; font-style: italic;
        text-align: center; padding: 40px 0;
      }
      .gallery-grid {
        display: grid; gap: 10px;
        grid-template-columns: repeat(auto-fill, minmax(var(--gallery-thumb, 180px), 1fr));
      }
      .gallery-card {
        background: #1e1a12; border: 1px solid #3a3020; border-radius: 4px;
        overflow: hidden; cursor: pointer;
        transition: border-color 0.15s, transform 0.15s;
      }
      .gallery-card:hover { border-color: #665; transform: translateY(-2px); }
      .gallery-card img {
        width: 100%; aspect-ratio: 4/3; object-fit: cover; display: block;
        background: #161210;
      }
      .gallery-card-label {
        padding: 4px 6px; font-family: monospace; font-size: 9px;
        color: #887; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
      }
      .gallery-card-category {
        font-size: 8px; color: #554; text-transform: uppercase; letter-spacing: 0.5px;
      }

      /* Fullscreen image view */
      #gallery-lightbox {
        position: fixed; inset: 0; background: rgba(0,0,0,0.85);
        z-index: 300; display: none; align-items: center; justify-content: center;
        cursor: pointer;
      }
      #gallery-lightbox.open { display: flex; }
      #gallery-lightbox { flex-direction: column; gap: 12px; }
      #gallery-lightbox img {
        max-width: 92vw; max-height: 80vh; object-fit: contain;
        border-radius: 4px; box-shadow: 0 4px 24px rgba(0,0,0,0.6);
      }
      #gallery-lightbox-info {
        max-width: 92vw; color: #ccc; font-size: 12px;
        text-align: center; padding: 0 20px;
      }
      #gallery-lightbox-model {
        color: #7a9ab8; font-weight: bold; font-size: 13px;
        text-transform: uppercase; letter-spacing: 1px;
      }
      #gallery-lightbox-prompt { color: #aaa; margin: 4px 0 0; font-style: italic; }
    </style>
    <script type="module" crossorigin src="/gensoftworks/assets/main-BdTKBkV8.js"></script>
    <link rel="modulepreload" crossorigin href="/gensoftworks/assets/StudioScene-DCgEznM_.js">
  </head>
  <body>
    <!-- Agent hover tooltip -->
    <div id="agent-tooltip"><div class="tt-name"><span class="tt-gender"></span><span class="tt-label"></span><span class="tt-flag"></span></div><div class="tt-role"></div></div>

    <!-- Agent profile modal -->
    <div id="agent-profile-overlay">
      <div id="agent-profile">
        <button class="profile-close" id="profile-close">&times;</button>
        <div class="profile-header">
          <span class="profile-icons" id="profile-icons"></span>
          <div>
            <div class="profile-name" id="profile-name"></div>
            <div class="profile-role" id="profile-role"></div>
            <div class="profile-room" id="profile-room"></div>
          </div>
        </div>
        <div class="memory-section" id="profile-memory"></div>
      </div>
    </div>

    <!-- Document chapter modal -->
    <div id="document-overlay">
      <div id="document-modal">
        <button class="doc-modal-close" id="doc-modal-close">&times;</button>
        <div class="doc-modal-header">
          <span class="badge doc-modal-badge" id="doc-modal-badge"></span>
          <span class="doc-modal-title" id="doc-modal-title"></span>
          <span class="doc-modal-version" id="doc-modal-version"></span>
        </div>
        <div class="doc-modal-nav" id="doc-modal-nav" style="display:none;">
          <button class="doc-modal-nav-btn" id="doc-ver-prev" title="Ältere Version">&lsaquo;</button>
          <span class="doc-modal-nav-label" id="doc-ver-label"></span>
          <button class="doc-modal-nav-btn" id="doc-ver-next" title="Neuere Version">&rsaquo;</button>
        </div>
        <div class="doc-modal-content" id="doc-modal-content"></div>
      </div>
    </div>

    <!-- Gallery lightbox -->
    <div id="gallery-lightbox">
      <img id="gallery-lightbox-img" src="" alt="">
      <div id="gallery-lightbox-info">
        <span id="gallery-lightbox-model"></span>
        <p id="gallery-lightbox-prompt"></p>
      </div>
    </div>

    <!-- Concept art gallery board -->
    <div id="gallery-overlay">
      <div id="gallery-board">
        <button class="gallery-close" id="gallery-close">&times;</button>
        <div class="gallery-header">CONCEPT ART</div>
        <div class="gallery-empty" id="gallery-empty">Noch keine Concept Art bis zu dieser Szene.</div>
        <div class="gallery-grid" id="gallery-grid"></div>
      </div>
    </div>

    <div id="wrapper">
      <div id="left">
        <div id="game-container"><div id="zone-overlay"></div></div>
        <div id="document-bar"><div id="document-bar-content"></div><button class="gallery-icon-btn" id="btn-gallery" title="Concept Art">&#x1F5BC;&#xFE0E;<span class="gallery-count" id="gallery-count"></span></button></div>
        <div id="audio-bar">
          <div class="audio-controls">
            <button class="audio-btn active" id="btn-audio-toggle" title="Ton an/aus">&#9834;</button>
            <input type="range" id="audio-volume" min="0" max="100" value="15" title="Lautstärke">
          </div>
          <div class="audio-credit">
            Music: <a href="https://freesound.org/people/Seth_Makes_Sounds/sounds/670039/" target="_blank">Seth_Makes_Sounds</a> (CC0)
            &middot; Typing: <a href="https://freesound.org/people/stu556/sounds/450281/" target="_blank">stu556</a> (CC0)
            &middot; Paper: <a href="https://freesound.org/people/davidbain/sounds/136778/" target="_blank">davidbain</a> (CC0)
            &middot; <a href="https://github.com/jenniferied/gensoftworks" target="_blank">GitHub</a>
          </div>
        </div>
        <div id="title-bar">GENSOFTWORKS — Gebäude 12, Obergeschoss</div>
      </div>
      <div id="sidebar">
        <div class="controls">
          <select id="sim-select" title="Simulation wählen"></select>
          <select id="day-select"></select>
          <div class="nav-group">
            <button class="nav-btn" id="btn-prev" title="Vorherige Szene">&lsaquo;</button>
            <select id="scene-select"></select>
            <button class="nav-btn" id="btn-next" title="Nächste Szene">&rsaquo;</button>
          </div>
        </div>
        <div class="divider"></div>

        <!-- Day summary bubble -->
        <div id="day-summary" class="day-summary" style="display: none;"></div>

        <!-- Scene info -->
        <div id="scene-info">
          <div class="scene-header">
            <span class="badge" id="scene-badge"></span>
            <span class="scene-time" id="scene-time"></span>
          </div>
          <div class="scene-location" id="scene-location"></div>
          <div class="scene-participants" id="scene-participants"></div>
          <div class="divider"></div>
          <div class="scene-summary" id="scene-summary"></div>
          <div class="key-moment" id="key-moment"></div>
          <div id="artifact-list" style="display: none;"></div>
        </div>

        <div class="divider"></div>

        <!-- Agent details (all participants, auto-expanded) -->
        <div id="agent-list"></div>
      </div>
    </div>
  </body>
</html>
