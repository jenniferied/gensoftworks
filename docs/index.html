<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GenSoftworks — Gebäude 7</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { background: #1a1a2e; overflow: hidden; font-family: monospace; color: #ccc; }
      #wrapper { display: flex; width: 100vw; height: 100vh; }
      #left { flex: 1; display: flex; flex-direction: column; min-width: 0; }
      #game-container { flex: 1; min-height: 0; position: relative; }
      #zone-overlay {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none; overflow: hidden; z-index: 10;
      }
      .zone-label {
        position: absolute; font-family: monospace; font-size: 12px;
        color: rgba(255,255,255,0.75); text-align: center; white-space: pre-line;
        text-shadow: 0 0 3px rgba(0,0,0,0.7);
        transform: translate(-50%, -50%);
      }
      #title-bar { text-align: center; padding: 6px 0; color: #556; font-size: 13px; letter-spacing: 2px; }

      /* --- Sidebar --- */
      #sidebar {
        width: 340px; min-width: 260px; background: #111122; border-left: 2px solid #333355;
        display: flex; flex-direction: column; padding: 12px; overflow-y: auto; overflow-x: hidden;
      }
      #sidebar .controls { display: flex; gap: 4px; margin-bottom: 10px; align-items: center; flex-wrap: wrap; }
      #sidebar .nav-btn {
        background: #1a1a2e; color: #88aacc; border: 1px solid #333355;
        padding: 4px 8px; font-family: monospace; font-size: 14px; border-radius: 3px;
        cursor: pointer; line-height: 1; flex-shrink: 0;
      }
      #sidebar .nav-btn:hover { border-color: #556699; color: #aac8e8; }
      #sidebar .nav-btn:disabled { opacity: 0.3; cursor: default; }
      #sidebar .nav-btn.playing { color: #e8a84c; border-color: #e8a84c; }
      #sim-select { flex: 0 1 auto; width: 100%; margin-bottom: 2px; }
      #sidebar select {
        flex: 1 1 0; min-width: 0; background: #1a1a2e; color: #ccc; border: 1px solid #333355;
        padding: 4px 6px; font-family: monospace; font-size: 12px; border-radius: 3px;
        cursor: pointer;
      }
      #day-select { flex: 0 1 auto; width: 70px; }
      #sidebar select:hover { border-color: #556699; }
      #sidebar .divider { height: 1px; background: #333355; margin: 8px 0; }

      /* Scene header */
      .scene-header { display: flex; align-items: center; gap: 6px; margin-bottom: 4px; flex-wrap: wrap; }
      .badge {
        display: inline-block; padding: 2px 6px; border-radius: 3px;
        font-size: 10px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px;
        color: #fff; background: #334; flex-shrink: 0;
      }
      .badge.MEETING, .badge.BRIEF_REACTION { background: #2a4a6a; }
      .badge.ARRIVAL { background: #2a5a3a; }
      .badge.ENCOUNTER { background: #5a4a2a; }
      .badge.WORK, .badge.WORK_REFLECTION { background: #4a2a5a; }
      .badge.REFLECTION { background: #3a3a5a; }
      .scene-time { font-size: 11px; color: #88aacc; }
      .scene-location { font-size: 11px; color: #889; margin-bottom: 3px; }
      .scene-participants { font-size: 11px; color: #aaa; margin-bottom: 6px; line-height: 1.4; }
      .scene-participants span { color: #aac8e8; }

      /* Summary */
      .scene-summary {
        font-size: 11px; color: #bbb; line-height: 1.5; word-wrap: break-word;
        overflow-wrap: break-word;
      }

      /* Key moment */
      .key-moment {
        font-size: 10px; color: #c8a86e; font-style: italic;
        margin-top: 6px; padding: 5px 7px; background: #1a1a2e; border-radius: 3px;
        border-left: 2px solid #c8a86e; word-wrap: break-word;
      }

      /* Artifacts */
      .artifacts-title {
        font-size: 10px; color: #556; text-transform: uppercase; letter-spacing: 1px;
        margin-top: 8px; margin-bottom: 4px;
      }
      .artifact-item {
        display: flex; align-items: center; gap: 4px;
        font-size: 10px; color: #889; padding: 2px 0;
      }
      .artifact-icon { color: #556; font-size: 9px; flex-shrink: 0; }
      .artifact-name {
        color: #7a9ab8; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
      }

      /* Agent details list */
      .agent-card { margin-bottom: 8px; padding-bottom: 6px; border-bottom: 1px solid #1a1a2e; }
      .agent-card-header { display: flex; align-items: baseline; gap: 5px; margin-bottom: 2px; flex-wrap: wrap; }
      .agent-name { font-size: 11px; font-weight: bold; color: #dde; }
      .agent-role { font-size: 10px; color: #667; }
      .mood-row { display: flex; gap: 4px; align-items: center; font-size: 11px; margin-bottom: 3px; flex-wrap: wrap; }
      .mood-label { color: #556; }
      .mood-value { color: #aac8e8; }
      .mood-arrow { color: #556; }
      .agent-reaction {
        font-size: 11px; color: #bbb; line-height: 1.4; margin-top: 4px;
        padding: 4px 6px; background: #1a1a2e; border-radius: 3px;
        word-wrap: break-word; overflow-wrap: break-word;
      }
      .agent-influences { font-size: 10px; color: #889; margin-top: 4px; word-wrap: break-word; }
      .agent-influences span { color: #7a9ab8; }

      /* Memories list */
      .memories-title { font-size: 10px; color: #556; text-transform: uppercase; letter-spacing: 1px; margin-top: 6px; margin-bottom: 3px; }
      .memory-item {
        font-size: 10px; color: #999; padding: 3px 0; border-bottom: 1px solid #222233;
        line-height: 1.3; word-wrap: break-word; overflow-wrap: break-word;
      }
      .memory-item .mem-type { color: #667; font-size: 9px; text-transform: uppercase; margin-right: 3px; }
      .memory-item .mem-importance { color: #c8a86e; font-size: 9px; float: right; }

      .agent-card.dimmed { opacity: 0.4; }

      /* v2: Dialogue lines */
      .dialogue-section { margin-top: 4px; }
      .dialogue-line {
        font-size: 10px; color: #aac8e8; font-style: italic;
        padding: 2px 0 2px 8px; border-left: 2px solid #334466;
        margin-bottom: 2px; word-wrap: break-word; overflow-wrap: break-word;
      }

      /* v2: Thoughts */
      .agent-thought {
        font-size: 10px; color: #b8a8c8; font-style: italic;
        padding: 3px 6px; margin-top: 3px; background: #1a1a2e; border-radius: 3px;
        border-left: 2px solid #4a3a5a; word-wrap: break-word; overflow-wrap: break-word;
      }

      /* v2: Feedback */
      .agent-feedback {
        font-size: 10px; padding: 3px 6px; margin-top: 3px; border-radius: 3px;
        word-wrap: break-word; overflow-wrap: break-word;
      }
      .agent-feedback.given { color: #8ab; background: #1a2030; border-left: 2px solid #3a5a6a; }
      .agent-feedback.received { color: #ab8; background: #201a1a; border-left: 2px solid #5a4a3a; }

      /* Agent hover tooltip */
      #agent-tooltip {
        position: absolute; pointer-events: none; z-index: 100;
        background: rgba(17,17,34,0.92); border: 1px solid #334466;
        border-radius: 4px; padding: 5px 9px; font-family: monospace;
        opacity: 0; transition: opacity 0.15s;
      }
      #agent-tooltip.visible { opacity: 1; }
      #agent-tooltip .tt-name { font-size: 11px; font-weight: bold; color: #dde; display: flex; align-items: center; gap: 5px; }
      #agent-tooltip .tt-gender { font-size: 12px; opacity: 0.7; }
      #agent-tooltip .tt-flag { font-size: 11px; }
      #agent-tooltip .tt-role { font-size: 10px; color: #88aacc; }

      /* Agent profile modal */
      #agent-profile-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.6);
        z-index: 200; display: none; align-items: center; justify-content: center;
      }
      #agent-profile-overlay.open { display: flex; }
      #agent-profile {
        background: #111122; border: 2px solid #333355; border-radius: 6px;
        width: 480px; max-width: 90vw; max-height: 80vh; overflow-y: auto;
        padding: 16px; font-family: monospace; color: #ccc; position: relative;
      }
      #agent-profile .profile-close {
        position: absolute; top: 8px; right: 12px;
        background: none; border: none; color: #667; font-size: 18px;
        cursor: pointer; font-family: monospace;
      }
      #agent-profile .profile-close:hover { color: #aac8e8; }
      #agent-profile .profile-header { margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
      #agent-profile .profile-icons { font-size: 16px; line-height: 1; }
      #agent-profile .profile-name { font-size: 16px; font-weight: bold; color: #dde; }
      #agent-profile .profile-role { font-size: 12px; color: #88aacc; margin-top: 2px; }
      #agent-profile .profile-room { font-size: 11px; color: #556; margin-top: 2px; }
      #agent-profile .section-toggle {
        background: #1a1a2e; border: 1px solid #333355; color: #88aacc;
        font-family: monospace; font-size: 11px; padding: 5px 10px;
        border-radius: 3px; cursor: pointer; width: 100%; text-align: left;
        margin-bottom: 4px; display: flex; align-items: center; gap: 6px;
      }
      #agent-profile .section-toggle:hover { border-color: #556699; color: #aac8e8; }
      #agent-profile .section-toggle .arrow { font-size: 9px; transition: transform 0.15s; display: inline-block; }
      #agent-profile .section-toggle .arrow.open { transform: rotate(90deg); }
      #agent-profile .section-body { margin-bottom: 8px; }
      #agent-profile .memory-entry {
        font-size: 11px; color: #bbb; line-height: 1.5; padding: 8px 0;
        border-bottom: 1px solid #222233; word-wrap: break-word;
      }
      #agent-profile .memory-entry-header {
        font-size: 10px; color: #c8a86e; font-weight: bold; margin-bottom: 3px;
      }
      #agent-profile .memory-empty { font-size: 11px; color: #556; font-style: italic; }
      #agent-profile .bio-row { font-size: 11px; color: #bbb; padding: 4px 0; border-bottom: 1px solid #222233; }
      #agent-profile .bio-label { color: #556; margin-right: 6px; }
      #agent-profile .bio-value { color: #aac8e8; }

      /* Audio bar */
      #audio-bar {
        display: flex; align-items: center; gap: 8px;
        padding: 4px 10px; background: #0d0d1a; border-top: 1px solid #222233;
        font-size: 10px; color: #445; min-height: 24px;
      }
      #audio-bar .audio-controls { display: flex; align-items: center; gap: 4px; flex-shrink: 0; }
      #audio-bar .audio-btn {
        background: none; border: none; color: #556; font-size: 13px;
        cursor: pointer; font-family: monospace; padding: 0 3px;
      }
      #audio-bar .audio-btn:hover { color: #88aacc; }
      #audio-bar .audio-btn.active { color: #aac8e8; }
      #audio-bar input[type="range"] {
        width: 60px; height: 3px; -webkit-appearance: none; appearance: none;
        background: #333355; border-radius: 2px; outline: none; cursor: pointer;
      }
      #audio-bar input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none; width: 10px; height: 10px;
        background: #88aacc; border-radius: 50%; cursor: pointer;
      }
      #audio-bar .audio-credit { flex: 1; text-align: right; color: #334; font-size: 9px; }
      #audio-bar .audio-credit a { color: #445; text-decoration: none; }
      #audio-bar .audio-credit a:hover { color: #667; }
    </style>
    <script type="module" crossorigin src="/gensoftworks/assets/index-DZpBlC84.js"></script>
  </head>
  <body>
    <!-- Agent hover tooltip -->
    <div id="agent-tooltip"><div class="tt-name"><span class="tt-gender"></span><span class="tt-label"></span><span class="tt-flag"></span></div><div class="tt-role"></div></div>

    <!-- Agent profile modal -->
    <div id="agent-profile-overlay">
      <div id="agent-profile">
        <button class="profile-close" id="profile-close">&times;</button>
        <div class="profile-header">
          <span class="profile-icons" id="profile-icons"></span>
          <div>
            <div class="profile-name" id="profile-name"></div>
            <div class="profile-role" id="profile-role"></div>
            <div class="profile-room" id="profile-room"></div>
          </div>
        </div>
        <div class="memory-section" id="profile-memory"></div>
      </div>
    </div>

    <div id="wrapper">
      <div id="left">
        <div id="game-container"><div id="zone-overlay"></div></div>
        <div id="audio-bar">
          <div class="audio-controls">
            <button class="audio-btn active" id="btn-audio-toggle" title="Ton an/aus">&#9834;</button>
            <input type="range" id="audio-volume" min="0" max="100" value="15" title="Lautstärke">
          </div>
          <div class="audio-credit">
            Music: <a href="https://freesound.org/people/Seth_Makes_Sounds/sounds/670039/" target="_blank">Seth_Makes_Sounds</a> (CC0)
            &middot; Typing: <a href="https://freesound.org/people/stu556/sounds/450281/" target="_blank">stu556</a> (CC0)
          </div>
        </div>
        <div id="title-bar">GENSOFTWORKS — Gebäude 7, Obergeschoss</div>
      </div>
      <div id="sidebar">
        <div class="controls">
          <select id="sim-select" title="Simulation wählen"></select>
          <button class="nav-btn" id="btn-prev" title="Vorherige Szene">&lsaquo;</button>
          <select id="day-select"></select>
          <select id="scene-select"></select>
          <button class="nav-btn" id="btn-next" title="Nächste Szene">&rsaquo;</button>
          <button class="nav-btn" id="btn-play" title="Autoplay">&#9654;</button>
        </div>
        <div class="divider"></div>

        <!-- Scene info -->
        <div id="scene-info">
          <div class="scene-header">
            <span class="badge" id="scene-badge"></span>
            <span class="scene-time" id="scene-time"></span>
          </div>
          <div class="scene-location" id="scene-location"></div>
          <div class="scene-participants" id="scene-participants"></div>
          <div class="divider"></div>
          <div class="scene-summary" id="scene-summary"></div>
          <div class="key-moment" id="key-moment"></div>
          <div id="artifact-list" style="display: none;"></div>
        </div>

        <div class="divider"></div>

        <!-- Agent details (all participants, auto-expanded) -->
        <div id="agent-list"></div>
      </div>
    </div>
  </body>
</html>
